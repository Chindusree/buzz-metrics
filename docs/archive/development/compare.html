<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUzz Metrics - Regex vs Groq</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Source Serif Pro', Georgia, serif; background: #f5f5f5; padding: 20px; }
        h1 { font-family: 'Inter', sans-serif; margin-bottom: 20px; }
        .banner { background: #ffeb3b; padding: 10px; text-align: center; margin-bottom: 20px; border-radius: 4px; }
        .summary { display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .stat { background: #fff; padding: 20px; border-radius: 8px; flex: 1; min-width: 150px; }
        .stat-value { font-size: 2em; font-weight: bold; }
        .stat-label { color: #666; font-size: 0.9em; }
        .groq-wins { color: #2e7d32; }
        .regex-wins { color: #1565c0; }
        table { width: 100%; background: #fff; border-collapse: collapse; border-radius: 8px; overflow: hidden; }
        th { background: #c41230; color: #fff; text-align: left; padding: 12px; font-family: 'Inter', sans-serif; }
        td { padding: 12px; border-bottom: 1px solid #eee; vertical-align: top; }
        tr:hover { background: #f9f9f9; }
        .diff-pos { color: #2e7d32; font-weight: bold; }
        .diff-neg { color: #c62828; font-weight: bold; }
        .diff-zero { color: #666; }
        .source-tag { display: inline-block; padding: 2px 8px; margin: 2px; border-radius: 4px; font-size: 0.85em; background: #e3f2fd; }
        .source-tag.original { background: #e8f5e9; }
        .source-tag.press_statement { background: #fff3e0; }
        .source-tag.social_media { background: #f3e5f5; }
        .gender { font-size: 0.75em; color: #666; }
        a { color: #1565c0; }
    </style>
</head>
<body>
    <div class="banner">⚠️ PRIVATE - Comparison view for testing only</div>

    <h1>Regex vs Groq Comparison</h1>

    <div class="summary">
        <div class="stat">
            <div class="stat-value" id="total">--</div>
            <div class="stat-label">Articles</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="regex-total">--</div>
            <div class="stat-label">Regex Sources</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="groq-total">--</div>
            <div class="stat-label">Groq Sources</div>
        </div>
        <div class="stat">
            <div class="stat-value groq-wins" id="groq-higher">--</div>
            <div class="stat-label">Groq Found More</div>
        </div>
        <div class="stat">
            <div class="stat-value regex-wins" id="regex-higher">--</div>
            <div class="stat-label">Regex Found More</div>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Article</th>
                <th>Regex</th>
                <th>Groq</th>
                <th>Diff</th>
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <script>
        async function loadData() {
            try {
                const response = await fetch('comparison.json');
                const data = await response.json();

                // Summary
                document.getElementById('total').textContent = data.summary.total_articles;
                document.getElementById('regex-total').textContent = data.summary.regex_total;
                document.getElementById('groq-total').textContent = data.summary.groq_total;
                document.getElementById('groq-higher').textContent = data.summary.groq_higher;
                document.getElementById('regex-higher').textContent = data.summary.regex_higher;

                // Table
                const tbody = document.getElementById('table-body');

                // Sort by difference (biggest gaps first)
                data.articles.sort((a, b) => Math.abs(b.difference) - Math.abs(a.difference));

                data.articles.forEach(article => {
                    const row = document.createElement('tr');

                    // Headline
                    row.innerHTML = `
                        <td><a href="${article.url}" target="_blank">${article.headline}</a></td>
                        <td>
                            <strong>${article.regex_count}</strong><br>
                            ${article.regex_sources.map(s => `<span class="source-tag">${s}</span>`).join('')}
                        </td>
                        <td>
                            <strong>${article.groq_count}</strong><br>
                            ${article.groq_sources.map(s => `
                                <span class="source-tag ${s.type}">${s.name}</span>
                                <span class="gender">(${s.gender})</span>
                            `).join('<br>')}
                        </td>
                        <td class="${article.difference > 0 ? 'diff-pos' : article.difference < 0 ? 'diff-neg' : 'diff-zero'}">
                            ${article.difference > 0 ? '+' : ''}${article.difference}
                        </td>
                    `;

                    tbody.appendChild(row);
                });
            } catch (e) {
                document.getElementById('table-body').innerHTML = '<tr><td colspan="4">Error loading comparison.json - run groq_verify.py first</td></tr>';
            }
        }

        loadData();
    </script>
</body>
</html>
